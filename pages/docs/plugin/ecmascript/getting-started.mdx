# Implementing a plugin

## Setup environment

### Install required toolchain

As plugin is written in the rust programming language and built as a `.wasm` file, you need to install rust toolchain and wasm target.

#### Install rust

You can follow instructions at ['Install Rust' page from the official rust website](https://www.rust-lang.org/tools/install)

#### Add wasm target to rust

SWC supports two kinds of `.wasm` files.
Those are

- wasm32-wasi
- wasm32-unknown-unknown

In this guide, we will use `wasm-wasi` as a target.

#### Install `swc_cli`

You can install a rust-based CLI for SWC by doing

```sh
cargo install swc_cli
```

#### Configuring IDE

If you are going to use vscode, it's recommended to install `rust-analyzer` extension.
`rust-analyzer` is a [language server](https://microsoft.github.io/language-server-protocol/) for the rust programming langauge, which provides good features for code completion, code navigation, and code analysis.

## Implementing simple plugin

### Create a project

SWC CLI supports creating a new plugin project.

Run

```
swc plugin new --target-type wasm32-wasi my-first-plugin
```

to create a new plugin, and open `my-first-plugin` with your preferred rust IDE.

### Add logic to the visitor

The generated code has

```rust
impl VisitMut for TransformVisitor {
    // Implement necessary visit_mut_* methods for actual custom transform.
    // A comprehensive list of possible visitor methods can be found here:
    // https://rustdoc.swc.rs/swc_ecma_visit/trait.VisitMut.html
}
```

which is used to transform code.
[The trait `VisitMut`](https://rustdoc.swc.rs/swc_ecma_visit/trait.VisitMut.html) supports mutating AST nodes, and as it supports all AST types, it has lots of methods.

Let's say, we want

## Testing your transform

### logging

SWC uses `tracing` for logging.

## Publising your plugin

### Removing log for release mode

If logging of yout crate is too much, you can remove it by enabling `release_max_level_*` of `tracing`, like

```toml
traicing = { version="0.1", features = ["release_max_level_info"] }
```
